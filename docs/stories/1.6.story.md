# Story 1.6: Pagebuilder Landing Page

## Status

**Review**

## Story

**As a** administrator,  
**I want** to be able to edit landing page content via the CMS,  
**so that** I can update the marketing page without modifying code.

## Dependencies

- **Story 1.3** (Completed): Payload CMS Integration
- **Story 1.5** (Completed): UI Foundation with shadcn/ui

## Acceptance Criteria

1. Page collection created in Payload with pagebuilder field
2. Minimum 3 block types implemented (Hero, Features, CTA)
3. Blocks have editable fields (title, text, image, buttons)
4. Frontend renders blocks dynamically based on CMS data
5. Landing page available at `/` and fetches data from Payload
6. Admin can add, remove, and reorder blocks
7. Changes in CMS reflect on frontend without redeploy
8. Block components use shadcn/ui for consistent design

## Tasks / Subtasks

- [ ] **Task 1: Create Payload Page Collection** (AC: 1, 6)
  - [ ] Define `Page` Collection in Payload (slug: `pages`)
  - [ ] Add fields: `title` (text), `slug` (text), `publishedAt` (date)
  - [ ] Add `layout` field using Payload's `blocks` field type
  - [ ] Enable `versions` and `drafts` for the collection
  - [ ] Generate TypeScript types for the new collection

- [ ] **Task 2: Define Content Blocks in Payload** (AC: 2, 3)
  - [ ] Create `Hero` block config (fields: title, subtitle, image, actions/links)
  - [ ] Create `Features` block config (fields: title, intro, items array with title/desc/icon)
  - [ ] Create `CTA` (Call to Action) block config (fields: title, content, buttons)
  - [ ] Register blocks in the `Page` collection's `layout` field
  - [ ] Verify blocks appear in Payload Admin UI

- [ ] **Task 3: Create Frontend Block Components** (AC: 4, 8)
  - [ ] Create `src/components/pagebuilder/` directory
  - [ ] Implement `HeroBlock` component using shadcn/ui (Button, etc.)
  - [ ] Implement `FeaturesBlock` component using shadcn/ui (Card, etc.)
  - [ ] Implement `CTABlock` component
  - [ ] Ensure all components are responsive (mobile/desktop)
  - [ ] **Mandatory:** Create skeleton components for each block type

- [ ] **Task 4: Implement Block Renderer** (AC: 4)
  - [ ] Create `src/components/pagebuilder/block-renderer.tsx`
  - [ ] Map Payload block types to React components
  - [ ] Handle "unknown block" case gracefully
  - [ ] Type the props correctly using generated Payload types

- [ ] **Task 5: specific Landing Page Route** (AC: 5, 7)
  - [ ] Create/Update `src/app/(marketing)/page.tsx`
  - [ ] Implement logic to fetch the "home" page from Payload (e.g., query by slug='home')
  - [ ] Render the `BlockRenderer` with the fetched `layout` data
  - [ ] Handle 404 if "home" page doesn't exist in CMS

- [ ] **Task 6: Verify and Content Entry** (AC: 6, 7)
  - [ ] Log in to Admin panel
  - [ ] Create a page with slug "home"
  - [ ] Add Hero, Features, and CTA blocks with test content
  - [ ] Verify the frontend at `/` renders the content correctly
  - [ ] Test reordering blocks in Admin and verify frontend update

## Dev Notes

### Previous Story Insights

[Source: docs/stories/1.5.story.md#Dev Agent Record]

- **Tailwind v4:** The project is using Tailwind CSS v4. Ensure any new styles or configurations overlap correctly.
- **shadcn/ui installed:** Components like Button and Card are available in `src/components/ui/` and should be reused in blocks.
- **Layouts:** Marketing layout should be distinct from the App layout if necessary, or reuse `MainLayout` if appropriate (PRD suggests `(marketing)` group implies minimal layout).

### Payload Page Builder Architecture

[Source: docs/architecture.md#Data Models]

- **Collection Name:** `pages`
- **Field Name:** `layout` (type: `blocks`)
- **Block Tables:** Payload handles block data storage automatically.

### Frontend Architecture

[Source: docs/architecture.md#Frontend Architecture]

- **Directory:** `components/pagebuilder/` for block components.
- **Skeleton Pattern:** MANDATORY. `HeroBlock` -> `HeroBlockSkeleton`.
- **Routing:** `app/(marketing)/` is the designated location for the landing page.

### Technical Constraints

[Source: docs/architecture.md#Tech Stack]

- **Fetching Data:** Use Payload's Local API (`payload.find`) if running server-side in Next.js, or REST/GraphQL if needed. Local API is preferred for performance in a monolithic setup.
- **Responsiveness:** Ensure blocks look good on mobile (<768px).
- **Images:** Use `next/image` for images served from Payload Media collection.

### Block Definitions (Content Brief Draft)

- **Hero:** Needs a high-impact headline, subheadline, and primary/secondary button group.
- **Features:** Grid layout (1 col mobile, 3 col desktop) showing value props.

### Testing

- **Test file location**: N/A (Manual verification primarily, optional unit tests in `src/components/pagebuilder/__tests__` if needed)
- **Test standards**: Use Vitest for unit tests if adding logic.
- **Testing frameworks**: Vitest, React Testing Library.

#### Manual Verification

- **Admin Workflow**: Create 'home' page -> Add blocks -> Save -> Publish.
- **Frontend Rendering**: Visit `http://localhost:3000/`. Verify content matches Admin.
- **Responsiveness**: Check Hero and Feature grid on mobile viewport.
- **Updates**: Change a title in Admin -> Refresh Frontend -> Verify change.

#### Automated Tests

- No new e2e tests required for this story.
- Unit tests for BlockRenderer mapping (optional).

## Change Log

| Date       | Version | Description                                           | Author   |
| :--------- | :------ | :---------------------------------------------------- | :------- |
| 2026-01-24 | 1.0     | Initial Draft                                         | PO Agent |
| 2026-01-24 | 1.1     | Added missing template sections and refined structure | PO Agent |

## Dev Agent Record

### Agent Model Used

- _TBD_

### Debug Log References

- _TBD_

### Completion Notes List

- _TBD_

### File List

- _TBD_

## QA Results

- _TBD_
